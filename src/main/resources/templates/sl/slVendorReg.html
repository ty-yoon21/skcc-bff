<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="user-scalable=yes, width=1920, height=964">
<title>RENEWUS</title>


<!-- Default JS, CSS - Start -->
<!--For jquery-->
<script th:src="@{/js/stdframework/ui/jquery-3.7.1.min.js}"></script>
<script th:src="@{/libs/stdframework/ui/jquery-ui-1.13.2/jquery-ui.min.js}"></script>
<!--Wijmo-->
<link rel="stylesheet" th:href="@{/libs/stdframework/ui/wijmo-5.20231.904/Dist/styles/wijmo.min.css}">
<script th:src="@{/libs/stdframework/ui/wijmo-5.20231.904/Dist/controls/wijmo.min.js}"></script>
<script th:src="@{/libs/stdframework/ui/wijmo-5.20231.904/Dist/controls/wijmo.input.min.js}"></script>
<script th:src="@{/libs/stdframework/ui/wijmo-5.20231.904/Dist/controls/wijmo.grid.min.js}"></script>
<script th:src="@{/libs/stdframework/ui/wijmo-5.20231.904/Dist/controls/wijmo.grid.selector.min.js}"></script>
<script th:src="@{/libs/stdframework/ui/wijmo-5.20231.904/Dist/controls/wijmo.grid.filter.min.js}"></script>
<script th:src="@{/libs/stdframework/ui/wijmo-5.20231.904/Dist/controls/wijmo.nav.min.js}"></script>
<script th:src="@{/libs/stdframework/ui/wijmo-5.20231.904/Dist/controls/wijmo.grid.sheet.min.js}"></script>
<script th:src="@{/libs/stdframework/ui/wijmo-5.20231.904/Dist/controls/wijmo.grid.xlsx.min.js}"></script>
<script th:src="@{/libs/stdframework/ui/wijmo-5.20231.904/Dist/controls/wijmo.xlsx.min.js}"></script>
<script th:src="@{/libs/stdframework/ui/jszip.min.js}"></script>

<!-- ui-std -->
<!-- <link rel="stylesheet" type="text/css" th:href="@{/css/stdframework/ui/skep-std-ui.css}"> -->
<link rel="stylesheet" type="text/css" th:href="@{/css/stdfw/skep-std-ui-bom.css}">
<script th:src="@{/js/stdframework/ui/common.js}"></script>
<script th:src="@{/js/stdframework/ui/moment.min.js}"></script>
<!-- <script th:src="@{/js/stdframework/ui/daterangepicker.js}"></script> -->
<script th:src="@{/js/stdframework/ui/select2.js}"></script>
<!-- <script th:src="@{/js/stdframework/ui/skep-std-ui.js}"></script> -->
<script th:src="@{/js/stdfw/skep-std-ui-bom.js}"></script>
<!-- <script th:src="@{/js/stdframework/cm/skep-std-favorite.js}"></script> -->
<script th:src="@{/js/stdfw/StdfrFavoriteMenus-bom.js}"></script>
<script th:src="@{/js/stdframework/ui/StdfrContentHeader.js}"></script>
<script th:src="@{/js/stdframework/ui/StdfrApi.js}"></script>
<!-- MDI Icon Pack  [http://meterialdesignicons.com] -->
<link rel="stylesheet" th:href="@{/libs/stdframework/ui/mdi/css/materialdesignicons.css}">
<!-- Common -->
<!-- <script th:src="@{/js/stdframework/ui/skep-wijmo.js}"></script> -->
<script th:src="@{/js/stdfw/skep-wijmo-bom.js}"></script>
<!--<meta id="_csrf" name="_csrf" th:content="${_csrf?.token}" />-->
<!--<meta id="_csrf_header" name="_csrf_header" th:content="${_csrf?.headerName}" />-->
<!--<meta id="_context_path" name="_context_path" th:content="${#request.getContextPath()}" />-->
<!-- Default JS, CSS - END -->

<!-- BOM JS, CSS- Start-->
<!-- common (Default) -->
<script th:src="@{/js/common/common-bom.js}"></script>
<script th:src="@{/js/common/daterangepicker.js}"></script>
<!-- popup (Custom)-->
<script th:src="@{/js/common/bomPopup.js}"></script>
<!-- BOM JS, CSS- End-->

</head>


<style>
    .form__group__tag strong {
        min-width: 81px;
    }
</style>


<body>
<div id="container" class="container">
    <!-- This is the area where the content header will be created. -->
    <div id="title"></div>
    <!-- All content must be written in the area("container__body flex_container") below. -->
    <div class="container__body flex_container">
        <div class="grid--full">
            <div class="grid__cell">
                <div class="cell__content--search">
                    <div class="grid--cols-2">
                        <div class="grid__cell--w-80">
                            <div class="form--cols-3">
                                <div class="form__group">
                                    <strong>검색</strong>
                                    <div>
                                        <p>
                                            <input type="text" id="sl-search-key" autocomplete="off" />
                                            <button class="clear__button"><i class="ico__close"></i></button>
                                        </p>
                                    </div>
                                </div>
                                <div class="form__group">
                                    <strong>지역구분</strong>
                                    <div>
                                        <p>
                                            <select id="sl-arCd"></select>
                                        </p>
                                    </div>
                                </div>
                                <div class="form__group">
                                    <strong>SAP 연계 여부</strong>
                                    <div>
                                        <p>
                                            <select id="sl-ifYn" data-searchyn="N">
                                                <option value=""></option>
                                                <option value="Y">Y</option>
                                                <option value="N">N</option>
                                            </select>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="grid__cell">
                            <div class="form--button">
                                <div class="button__group">
                                    <button type="button" class="btn--outline--primary" onclick="resetSearchBox();">초기화</button>
                                    <button type="button" class="btn--primary" onclick="searchVendor();"
                                    >조회
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <!-- Menu Contents -->
        <div class="grid">

            <div class="grid__cell--w-50 menu_view">
                <div class="cell__header">
                    <div class="title">
                        <strong>슬러지 거래처 목록</strong>
                        <div class="button__group">
                            <button type="button" class="btn--sm--outline--dark" onclick="fgExcel();"><i
                                    class="ico__download--dark"></i>Excel Download
                            </button>
                        </div>
                    </div>
                </div>
                <div class="cell__content">
                    <div id="fg1"></div>
                </div>
            </div>

            <div class="resizer" data-direction="horizontal"></div>

            <div class="grid__cell detail_grid">
                <div class="cell__header">
                    <div class="title">
                        <strong>기본 정보</strong>
                    </div>
                    <div class="button__group">
                        <div class="button__group">
                            <button type="button" class="btn--sm--success-ligh" onclick="resetDiv3();"
                            >추가</button>
                            <button type="button" class="btn--sm--danger" onclick="deleteVendor();"
                            >삭제</button>
                            <button type="button" class="btn--sm--primary" onclick="createNewVendor();"
                            >저장</button>
                        </div>
                    </div>
                </div>
                <div class="cell__content">

                    <div class="grid--cols-2">
                        <div class="grid__cell--w-100">
                            <div class="form--cols-3 form__group__tag">

                                <div class="form__group">
                                    <strong>업체코드</strong>
                                    <div>
                                        <p>
                                            <input type="text" id="vdCd" maxlength="20" readonly disabled />

                                        </p>
                                    </div>
                                </div>
                                <div class="form__group">
                                    <strong>업체명 *</strong>
                                    <div>
                                        <p>
                                            <input type="text" id="vdNm" maxlength="200" autocomplete="off"/>
                                        </p>
                                    </div>
                                </div>

                                <div class="form__group">
                                    <strong>업체영문명</strong>
                                    <div>
                                        <p>
                                            <input type="text" id="vdEngNm" maxlength="200" autocomplete="off"/>
                                        </p>
                                    </div>
                                </div>
                                <div class="form__group">
                                    <strong>등록일자 *</strong>
                                    <div>
                                        <p>
                                            <input type="text" class="datepicker" id="regYmd" autocomplete="off"/>
                                            <button class="clear__button"><i class="ico__close"></i></button>
                                        </p>
                                    </div>
                                </div>
                                <div class="form__group">
                                    <strong>사업자번호*</strong>
                                    <div>
                                        <p>
                                            <input type="text" id="bizRegNo" maxlength="20" autocomplete="off"/>

                                        </p>
                                    </div>
                                </div>

                                <div class="form__group">
                                    <strong>법인번호</strong>
                                    <div>
                                        <p>
                                            <input type="text" id="corpNo" maxlength="20" autocomplete="off"/>
                                        </p>
                                    </div>
                                </div>

                                <div class="form__group">
                                    <strong>설립일자</strong>
                                    <div>
                                        <p>
                                            <input type="text" class="datepicker" id="foundYmd" autocomplete="off">
                                            <button class="clear__button"><i class="ico__close"></i></button>
                                        </p>
                                    </div>
                                </div>
                                <div class="form__group">
                                    <strong>업태 *</strong>
                                    <div>
                                        <p>
                                            <input type="text" id="bizCond" maxlength="100" autocomplete="off"/>

                                        </p>
                                    </div>
                                </div>

                                <div class="form__group">
                                    <strong>업종 *</strong>
                                    <div>
                                        <p>
                                            <input type="text" id="bizKind" maxlength="100" autocomplete="off"/>
                                        </p>
                                    </div>
                                </div>
                                <div class="form__group">
                                    <strong>대표자 *</strong>
                                    <div>
                                        <p>
                                            <input type="text" id="reprsNm" maxlength="100" autocomplete="off"/>
                                        </p>
                                    </div>
                                </div>

                                <div class="form__group">
                                    <strong>회계업체코드</strong>
                                    <div>
                                        <p>
                                            <input type="text" id="fiVdCd" maxlength="20" disabled
                                                   style="position: absolute; left: -9999px;" />
                                            <input type="text" id="fiVdNm" maxlength="20" disabled />
                                            <button class="clear__button"><i
                                                    class="ico__close"></i></button>
                                            <button id="openSapVendorPop" onclick="sapPopup.open();"><i class="mdi mdi-magnify"></i></button>
                                        </p>
                                    </div>
                                </div>
                                <div class="form__group">

                                </div>
                                <div class="form__group">
                                    <strong>기업구분</strong>
                                    <div>
                                        <p>
                                            <select id="compSe"></select>
                                        </p>
                                    </div>
                                </div>
                                <div class="form__group">
                                    <strong>업체구분</strong>
                                    <div>
                                        <p>
                                            <select id="vdSe"></select>
                                        </p>
                                    </div>
                                </div>
                                <div class="form__group">
                                    <strong>지역구분</strong>
                                    <div>
                                        <p>
                                            <select data-select2-id="payment-detail-paymentTypeCode" id="arCd"
                                                    tabindex="-1" class="select2-hidden-accessible" aria-hidden="true">
                                            </select>
                                        </p>
                                    </div>
                                </div>
                                <div class="form__group">
                                    <strong>전화번호</strong>
                                    <div>
                                        <p>
                                            <input type="text" id="telNo" maxlength="50" autocomplete="off"/>
                                        </p>
                                    </div>
                                </div>
                                <div class="form__group">
                                    <strong>팩스번호</strong>
                                    <div>
                                        <p>
                                            <input type="text" id="faxNo" maxlength="50" autocomplete="off"/>

                                        </p>
                                    </div>
                                </div>
                                <div class="form__group">
                                    <strong>홈페이지</strong>
                                    <div>
                                        <p>
                                            <input type="text" id="homePage" maxlength="100" autocomplete="off"/>
                                        </p>
                                    </div>
                                </div>
                                <div class="form__group">
                                    <strong>우편번호</strong>
                                    <div>
                                        <p>
                                            <input type="text" id="zipCd" maxlength="10" autocomplete="off"/>
                                        </p>
                                    </div>
                                </div>
                                <div class="form__group">
                                    <strong>주소</strong>
                                    <div>
                                        <p>
                                            <input type="text" id="addr" maxlength="200" autocomplete="off"/>

                                        </p>
                                    </div>
                                </div>
                                <div class="form__group">
                                    <strong>주소상세</strong>
                                    <div>
                                        <p>
                                            <input type="text" id="addrDt" maxlength="100" autocomplete="off"/>
                                        </p>
                                    </div>
                                </div>
                                <p hidden id="picNm"></p>
                                <p hidden id="picEmail"></p>
                                <p hidden id="priRegYn"></p>
                                <p hidden id="regId"></p>
                                <p hidden id="regDt"></p>
                                <p hidden id="modId"></p>
                                <p hidden id="modDt"></p>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>


<script>

    /* Contents
A. Set Global Variables
B. Init Function
C. Multi Language
D. Functions
E. Grids
    E.1 fg1 init
    E.2 fg1 settings
    E.3 fg2 init
    E.4 fg2 settings
    E.5 grid function
*/
    // crsf & api (Default) -- Start
    const contextPath = $("meta[name='_context_path']").attr("content") ?? "";
    const csrfHeader = $("meta[name='_csrf_header']").attr("content");
    const csrfToken = $("meta[name='_csrf']").attr("content");

    const api = new StdfrApi({
        csrfHeader: csrfHeader,
        csrfToken: csrfToken
    });
    const header = new StdfrContentHeader({
        targetElement: document.getElementById("title"),
    });
    header.init();

    // crsf & api (Default) -- END

    let vendorDetail;

    //onload function
    $(document).ready(function () {
        //[1] project selectBox & fg1 grid data load
        // getSelectBoxArCd().then(function (data) {
        //     searchVendor();
        // });
        // getSelectBoxCompSe();
        // getSelectBoxVdSe();
    });

    let sapPopup = new SapVendorPopup({
        onConfirm: function (result) {
            document.getElementById('fiVdCd').value = result[0].fiVdCd;
            document.getElementById('fiVdNm').value = result[0].fiVdNm;
            document.getElementById('bizRegNo').value = result[0].bizRegNo;
            document.getElementById('bizCond').value = result[0].bizCond;
            document.getElementById('bizKind').value = result[0].bizKind;
            document.getElementById('reprsNm').value = result[0].reprsNm;
            document.getElementById('vdNm').value = result[0].fiVdNm;
            document.getElementById('zipCd').value = result[0].zipCd;
            document.getElementById('addr').value = result[0].addr;
            document.getElementById('addrDt').value = result[0].addrDt;
        },
        isMultiple: false
    });

    let fg1 = skepStdWijmo.flexGrid.init('#fg1', {

        columns: [
            { binding: 'vdCd', visible: false },
            { binding: 'vdNm', header: '업체명', align: "left", width: "1.5*", isReadOnly: true },
            { binding: 'vdEngNm', header: '업체영문명', align: "left", width: "1*", isReadOnly: true },
            { binding: 'bizRegNo', header: '사업자번호', align: "center", width: "1*", isReadOnly: true, cellTemplate: (ctx) => ctx.text ? formatBizRegNo(ctx.text) : '' },
            { binding: 'reprsNm', header: '대표자', align: "center", width: "1*", isReadOnly: true },
            { binding: 'fiVdCd', header: '회계거래처', isReadOnly: true, visible: false },
            { binding: 'fiVdNm', header: '회계거래처', align: "left", width: "1*", isReadOnly: true },
            { binding: 'priRegYn', header: '단가등록여부', align: "center", width: "1*", isReadOnly: true }
        ],
        selectionMode: "Row",
    });
    fg1.itemsSource.currentChanged.addHandler(function(s, e) {
        getVendorDetail();
    })

    function formatGetDateFunc(inputDate) {
        if (inputDate === undefined || inputDate === '' || inputDate === null) {
            return null;
        }
        console.log('input date', inputDate);
        const year = inputDate.substring(0, 4);
        const month = inputDate.substring(4, 6);
        const date = inputDate.substring(6, 8);
        console.log(`${year}-${month}-${date}`);
        return `${year}-${month}-${date}`;

    }
    function searchVendor() {
        let params = {
            key: document.getElementById('sl-search-key').value,
            arCd: document.getElementById('sl-arCd').value,
            ifYn: document.getElementById('sl-ifYn').value,
        }
        return new Promise ((resolve, reject) => {
            api.ajax({
                url: contextPath + "/sl/api/sl-vendor-reg/find-sl-vd",
                type: 'GET',
                data: params,
                success: function (res) {
                    fg1._cv.sourceCollection = res.result;
                    resolve();
                },
                error: function (res) {
                    console.log('FUNCTION ERROR', res)
                    skep.ui.msg.alert('오류가 발생하였습니다.');
                    reject();
                }
            });
        })
    };
    function getSelectBoxArCd() {
        return new Promise(function (resolve, reject) {
            let LIST_ARCD = [];
            LIST_ARCD.push({ value: "", name: "" });
            let param = {
                cdCl: 'AR_CD'
            }
            api.ajax({
                url: contextPath + "/scm/api/findsystemcodelistbycdcl",
                type: 'GET',
                data: param,
                success: function (res) {
                    if (res.responseCode == 'SUCCESS') {
                        for (let i = 0; i < res.result.length; i++) {

                            let objCombo = new Object();
                            objCombo.value = res.result[i].cd;
                            objCombo.name = res.result[i].cdNm;

                            LIST_ARCD.push(objCombo);
                        }
                        setOptions('sl-arCd', LIST_ARCD);
                        setOptions('arCd', LIST_ARCD);
                        resolve('success');
                    } else {
                        skep.ui.msg.alert('오류가 발생하였습니다.');
                        reject('error');
                    }
                },
                error: function (res) {
                    skep.ui.msg.alert('오류가 발생하였습니다.');
                    reject('error');
                }
            });

        });
    }
    function getSelectBoxCompSe() {
        return new Promise(function (resolve, reject) {
            // (Custom) - Load System Coomon Code - Start
            let param = {
                cdCl: 'COMP_SE'
            }
            LIST_COMPSE = [];
            LIST_COMPSE.push({ value: "", name: "" });
            api.ajax({
                url: contextPath + "/scm/api/findsystemcodelistbycdcl",
                type: 'GET',
                data: param,
                success: function (res) {
                    if (res.responseCode == 'SUCCESS') {
                        for (let i = 0; i < res.result.length; i++) {

                            let objCombo = new Object();
                            objCombo.value = res.result[i].cd;
                            objCombo.name = res.result[i].cdNm;

                            LIST_COMPSE.push(objCombo);
                        }
                        setOptions('compSe', LIST_COMPSE);
                        resolve('success');
                    } else {
                        skep.ui.msg.alert('오류가 발생하였습니다.');
                        reject('error');
                    }
                },
                error: function (res) {
                    skep.ui.msg.alert('오류가 발생하였습니다.');
                    reject('error');
                }
            });

        });
    }
    function getSelectBoxVdSe() {
        return new Promise(function (resolve, reject) {
            // (Custom) - Load System Coomon Code - Start
            let param = {
                cdCl: 'VD_SE'
            }
            LIST_VDSE = [];
            LIST_VDSE.push({ value: "", name: "" });
            api.ajax({
                url: contextPath + "/scm/api/findsystemcodelistbycdcl",
                type: 'GET',
                data: param,
                success: function (res) {
                    if (res.responseCode == 'SUCCESS') {
                        for (let i = 0; i < res.result.length; i++) {

                            let objCombo = new Object();
                            objCombo.value = res.result[i].cd;
                            objCombo.name = res.result[i].cdNm;

                            LIST_VDSE.push(objCombo);
                        }
                        setOptions('vdSe', LIST_VDSE);
                        resolve('success');
                    } else {
                        skep.ui.msg.alert('오류가 발생하였습니다.');
                        reject('error');
                    }
                },
                error: function (res) {
                    skep.ui.msg.alert('오류가 발생하였습니다.');
                    reject('error');
                }
            });

        });
    }

    function hideSapVendorIcon() {
        var divElement = document.getElementById("openSapVendorPop");
        divElement.style.display = "none";
    }

    function displaySapVendorIcon() {
        var divElement = document.getElementById("openSapVendorPop");
        divElement.style.display = "flex";
    }

    function getVendorDetail() {
        return new Promise(function (resolve, reject) {

            hideSapVendorIcon();

            // (Custom) - Load System Coomon Code - Start
            if (skepStdWijmo.flexGrid.getCurrentItemJson(fg1) == null) {
                resetDiv3();
                return;
            }
            let param = {
                vdCd: skepStdWijmo.flexGrid.getCurrentItemJson(fg1).vdCd,
            }
            api.ajax({
                url: contextPath + "/sl/api/sl-vendor-reg/find-sl-vd-detail",
                type: 'GET',
                data: param,
                success: function (res) {
                    if (res.responseCode == 'SUCCESS') {
                        vendorDetail = res.result;
                        $('#vdCd').val(vendorDetail.vdCd);
                        $('#vdNm').val(vendorDetail.vdNm);
                        $('#vdEngNm').val(vendorDetail.vdEngNm);
                        $('#regYmd').val(formatGetDateFunc(vendorDetail.regYmd));
                        $('#bizRegNo').val(vendorDetail.bizRegNo);
                        $('#corpNo').val(vendorDetail.corpNo);
                        $('#foundYmd').val(formatGetDateFunc(vendorDetail.foundYmd));
                        $('#bizCond').val(vendorDetail.bizCond);

                        $('#bizKind').val(vendorDetail.bizKind);
                        $('#reprsNm').val(vendorDetail.reprsNm);
                        $('#fiVdCd').val(vendorDetail.fiVdCd);
                        $('#fiVdNm').val(vendorDetail.fiVdNm);

                        $('#compSe').val(vendorDetail.compSe).change();

                        $('#vdSe').val(vendorDetail.vdSe).change();
                        $('#arCd').val(vendorDetail.arCd).change();

                        $('#telNo').val(vendorDetail.telNo);
                        $('#faxNo').val(vendorDetail.faxNo);
                        $('#homePage').val(vendorDetail.homePage)
                        $('#zipCd').val(vendorDetail.zipCd);
                        $('#addr').val(vendorDetail.addr);
                        $('#addrDt').val(vendorDetail.addrDt)

                    } else {
                        skep.ui.msg.alert('오류가 발생하였습니다.');
                        reject('error');
                    }
                },
                error: function (res) {
                    skep.ui.msg.alert('오류가 발생하였습니다.');
                    reject('error');
                }
            });

        });
    }

    function formatSaveDateFunc(inputDate) {
        if (inputDate === undefined || inputDate === '' || inputDate === null) {
            return null;
        }
        if (inputDate instanceof Date) {
            return inputDate.yyyymmdd().replaceAll("-", "")
        }
        return inputDate.replaceAll("-", "");
    }
    function createNewVendor() {
        return new Promise(function (resolve, reject) {
            let fiVdCd = $('#fiVdCd').val();
            let regYmdVal = formatSaveDateFunc($('#regYmd').val());
            let foundYmdVal = formatSaveDateFunc($('#foundYmd').val());
            // let foundYmdVal = $('#foundYmdVal').val().replaceAll("-", "");

            const vdNm = $('#vdNm').val();
            const regYmd = $('#regYmd').val();
            const bizRegNo = $('#bizRegNo').val();
            const bizCond = $('#bizCond').val();
            const bizKind = $('#bizKind').val();
            const reprsNm = $('#reprsNm').val();

            if(!vdNm) {
                skep.ui.msg.alertError('업체명은 필수 입력항목입니다.');
                return;
            }
            if(!regYmd) {
                skep.ui.msg.alertError('등록일자는 필수 입력항목입니다.');
                return;
            }
            if(!bizRegNo) {
                skep.ui.msg.alertError('사업자번호는 필수 입력항목입니다.');
                return;
            }
            if(!bizCond) {
                skep.ui.msg.alertError('업태는 필수 입력항목입니다.');
                return;
            }
            if(!bizKind) {
                skep.ui.msg.alertError('업종은 필수 입력항목입니다.');
                return;
            }
            if(!reprsNm) {
                skep.ui.msg.alertError('대표자는 필수 입력항목입니다.');
                return;
            }

            if (regYmdVal != null && !isValidDate(regYmdVal) ||
                foundYmdVal != null && !isValidDate(foundYmdVal)) {
                skep.ui.msg.alert('날짜입력값이 유효하지 않습니다.', "msg.errorDateFormat");
                return;
            }

            // (Custom) - Load System Coomon Code - Start
            let param = {
                vdCd: $('#vdCd').val(),
                vdNm: $('#vdNm').val(),
                vdEngNm: $('#vdEngNm').val(),
                regYmd: regYmdVal,
                bizRegNo: $('#bizRegNo').val(),
                corpNo: $('#corpNo').val(),
                foundYmd: foundYmdVal,
                bizCond: $('#bizCond').val(),
                bizKind: $('#bizKind').val(),
                reprsNm: $('#reprsNm').val(),
                fiVdCd: fiVdCd,
                compSe: $('#compSe').val(),
                vdSe: $('#vdSe').val(),
                arCd: $('#arCd').val(),
                telNo: $('#telNo').val(),
                faxNo: $('#faxNo').val(),
                homePage: $('#homePage').val(),
                zipCd: $('#zipCd').val(),
                addr: $('#addr').val(),
                addrDt: $('#addrDt').val()
            }

            skep.ui.msg.confirmYesno('저장하시겠습니까?').then(result => {
                if (result) {
                    api.ajax({
                        url: contextPath + "/sl/api/sl-vendor-reg/save-sl-vd",
                        type: 'POST',
                        contentType: 'application/json',
                        data: JSON.stringify(param),
                        success: function (res) {
                            if (res.responseCode === 'SUCCESS') {
                                console.log('success')
                                skep.ui.msg.alert('저장되었습니다.');

                                const vdCd = $('#vdCd').val();
                                if(vdCd) {  // update
                                    searchVendor().then(() => {
                                        fg1.select(fg1.itemsSource.items.findIndex(i => i.vdCd == vdCd), 0);
                                    });
                                } else {    // insert
                                    searchVendor().then(() => {
                                        fg1.select(fg1.itemsSource.items.findIndex(i => i.vdCd == res.result), 0);
                                    });
                                }
                            } else {
                                console.log('fail')
                                skep.ui.msg.alert('오류가 발생하였습니다.');
                                reject('error');
                            }
                        },
                        error: function (res) {
                            skep.ui.msg.alert('오류가 발생하였습니다.');
                            reject('error');
                        }
                    });
                }
            });//end confirmYesorNo

        });
    }
    function deleteVendor() {
        if(vendorDetail.priRegYn != null && vendorDetail.priRegYn == "Y") {
            skep.ui.msg.alert('단가 등록이 완료되어 삭제가 불가합니다.');
            return;
        }

        if (vendorDetail.vdCd == null || vendorDetail.vdCd == "") {
            skep.ui.msg.alert('업체가 선택되지 않았습니다.');
            return;
        }

        return new Promise(function (resolve, reject) {
            // (Custom) - Load System Coomon Code - Start
            let param = {
                vdCd: $('#vdCd').val()
            }
            skep.ui.msg.confirmYesno('삭제하시겠습니까?').then(result => {
                if (result) {
                    api.ajax({
                        url: contextPath + "/sl/api/sl-vendor-reg/delete-sl-vd",
                        type: 'POST',
                        data: param,
                        success: function (res) {
                            if (res.responseCode === 'SUCCESS') {
                                // console.log('deleted......')
                                skep.ui.msg.alert('삭제되었습니다.');
                            } else if (res.responseCode === 'FAIL') {
                                // console.log('delete fail......')
                                skep.ui.msg.alert(res.message);
                                reject('error');
                            }
                            else {
                                // console.log('delete error......')
                                skep.ui.msg.alert('오류가 발생하였습니다.');
                                reject('error');
                            }
                            searchVendor();
                            resetDiv3();
                        },
                        error: function (res) {
                            console.log('Error', res)
                            skep.ui.msg.alert('오류가 발생하였습니다.');
                            reject('error');
                        }
                    });
                }
            });//end confirm

        });
    }
    function resetDiv3() {
        displaySapVendorIcon();
        $('#vdCd').val(null);
        $('#vdNm').val(null);
        $('#vdEngNm').val(null);
        $('#regYmd').val(null);
        $('#bizRegNo').val(null);
        $('#corpNo').val(null);
        $('#foundYmd').val(null);
        $('#bizCond').val(null);

        $('#bizKind').val(null);
        $('#reprsNm').val(null);
        $('#fiVdCd').val(null);
        $('#fiVdNm').val(null);
        $('#compSe').val(null).change();

        $('#vdSe').val(null).change();
        $('#arCd').val(null).change();
        $('#telNo').val(null);
        $('#faxNo').val(null);
        $('#homePage').val(null)
        $('#zipCd').val(null);
        $('#addr').val(null);
        $('#addrDt').val(null);

        vendorDetail.vdCd = "";
        vendorDetail.priRegYn = "N";
    }

    function fgExcel() {
        skepStdWijmo.flexGrid.excelExport(fg1, '슬러지_거래처_등록');
    }

    function resetSearchBox() {
        resetSbInput('sl-search-key');
        $('#sl-arCd').val('').change();
        $('#sl-ifYn').val('').change();
    }
</script>
</body>

</html>